<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Siry Chat - å…¼å®¹æ¨¡å¼</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background: #f0f0f0; }
        #chatBox { border: 1px solid #999; height: 400px; overflow-y: scroll; padding: 10px; background: white; margin-bottom: 10px; }
        .userMsg { text-align: right; color: blue; margin: 5px; }
        .botMsg { text-align: left; color: green; margin: 5px; }
        input, button { padding: 10px; margin: 5px; font-size: 16px; }
    </style>
</head>
<body>
    <h2>ğŸ¤– Siry èŠå¤©å®¤ (å…¼å®¹æ¨¡å¼)</h2>
    <p><strong>æ³¨æ„ï¼š</strong>æ­¤é¡µé¢ä¸ºæ—§ç‰ˆæµè§ˆå™¨ä¼˜åŒ–ï¼ŒåŠŸèƒ½å®Œæ•´ï¼Œæ ·å¼ç®€åŒ–ã€‚</p>
    <div id="chatBox">
        <div class="botMsg"><strong>Siry:</strong> ä½ å¥½ï¼æˆ‘å·²è¿›å…¥å…¼å®¹æ¨¡å¼ã€‚æˆ‘ä»¬å¯ä»¥å¼€å§‹èŠå¤©äº†ã€‚</div>
    </div>
    <input type="text" id="userInput" placeholder="è¾“å…¥æ¶ˆæ¯..." style="width: 70%;">
    <button onclick="sendMsg()">å‘é€</button>
    <p style="margin-top: 30px; font-size: 0.9em; color: #666;">
        <a href="index.html">â† è¿”å›ä¸»ç•Œé¢</a> | 
        AIç”Ÿæˆå†…å®¹å¯èƒ½ä¸å‡†ç¡®ã€‚åŸºäºAGPL-3.0è®¸å¯è¯ã€‚
    </p>

    <script>
        // ======== é…ç½®ï¼ˆå¿…é¡»ä¸ä¸»é¡µé¢ä¸€è‡´ï¼ï¼‰ ========
        const API_KEY = 'sk-xzxelritwcuswjbfgwqtcdqsemtlnluceaurjscdkyezjpik';
        const MODEL = 'THUDM/GLM-4-9B-0414';
        const SYSTEM_PROMPT = `ä½ æ˜¯Siryï¼ˆå°é”ï¼‰ï¼Œä¸€ä¸ªå¹½é»˜åˆæ•é”çš„åŠ©æ‰‹ã€‚è¯·ç”¨ä¸­æ–‡ç®€çŸ­å›ç­”ã€‚`;
        // ===========================================
        function sendMsg() {
            const input = document.getElementById('userInput');
            const msg = input.value;
            if (!msg) return;
            const chatBox = document.getElementById('chatBox');
            chatBox.innerHTML += `<div class="userMsg"><strong>ä½ :</strong> ${msg}</div>`;
            input.value = '';
            chatBox.innerHTML += `<div class="botMsg"><strong>Siry:</strong> æ€è€ƒä¸­...</div>`;
            chatBox.scrollTop = chatBox.scrollHeight;
            fetch('https://api.siliconflow.cn/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + API_KEY,
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    model: MODEL,
                    messages: [
                        {role: "system", content: SYSTEM_PROMPT},
                        {role: "user", content: msg}
                    ]
                })
            })
            .then(r => r.json())
            .then(d => {
                const reply = d.choices && d.choices[0] ? d.choices[0].message.content : 'å‡ºé”™';
                chatBox.lastChild.innerHTML = `<strong>Siry:</strong> ${reply}`;
                chatBox.scrollTop = chatBox.scrollHeight;
            })
            .catch(e => {
                chatBox.lastChild.innerHTML = `<strong>Siry:</strong> ç½‘ç»œé”™è¯¯ã€‚`;
            });
        }
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') sendMsg();
        });
    </script>
</body>
</html>